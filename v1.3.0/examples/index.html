<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · ExponentialFamily.jl</title><meta name="title" content="Examples · ExponentialFamily.jl"/><meta property="og:title" content="Examples · ExponentialFamily.jl"/><meta property="twitter:title" content="Examples · ExponentialFamily.jl"/><meta name="description" content="Documentation for ExponentialFamily.jl."/><meta property="og:description" content="Documentation for ExponentialFamily.jl."/><meta property="twitter:description" content="Documentation for ExponentialFamily.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ExponentialFamily.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../interface/">Interface</a></li><li><a class="tocitem" href="../library/">Library</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#examples-product"><span>Product of two probability distributions over the same variable</span></a></li><li><a class="tocitem" href="#Computing-various-useful-attributes-of-an-exponential-family-member"><span>Computing various useful attributes of an exponential family member</span></a></li><li><a class="tocitem" href="#Approximating-attributes"><span>Approximating attributes</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ReactiveBayes/ExponentialFamily.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ReactiveBayes/ExponentialFamily.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="examples"><a class="docs-heading-anchor" href="#examples">Examples</a><a id="examples-1"></a><a class="docs-heading-anchor-permalink" href="#examples" title="Permalink"></a></h1><h2 id="examples-product"><a class="docs-heading-anchor" href="#examples-product">Product of two probability distributions over the same variable</a><a id="examples-product-1"></a><a class="docs-heading-anchor-permalink" href="#examples-product" title="Permalink"></a></h2><p>In this example, we&#39;ll show you how to use the ExponentialFamily package to calculate the product of probability distributions that both relate to the same variable &quot;X&quot;.  This operation results in another probability distribution, also centered around the variable &quot;X&quot;.  It&#39;s essential to note that this is distinct from multiplying probability distributions for two different variables, such as &quot;X&quot; and &quot;Y&quot;,  which yields a joint probability distribution. Calculating the product of two probability distributions over the same variable is a crucial step in applying Bayes&#39; rule.</p><p class="math-container">\[p(X\vert D) \propto \underbrace{p(X)p(D|X)}_{\mathrm{product~of~two~distributions}}\]</p><p>To perform this operation, the ExponentialFamily library employs the <code>prod</code> function. This function takes a product strategy as its first argument. For instance:</p><pre><code class="language-julia hljs">using ExponentialFamily, Distributions, BayesBase

prior = Bernoulli(0.5)
likelihood = Bernoulli(0.6)

posterior = prod(PreserveTypeProd(Distribution), prior, likelihood)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Bernoulli{Float64}(p=0.6)</code></pre><p>You can achieve the same result in the general exponential family form, which operates within the natural parameter space:</p><pre><code class="language-julia hljs">ef_prior = convert(ExponentialFamilyDistribution, prior)
ef_likelihood = convert(ExponentialFamilyDistribution, likelihood)

ef_posterior = prod(PreserveTypeProd(ExponentialFamilyDistribution), ef_prior, ef_likelihood)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ExponentialFamily(Bernoulli)</code></pre><p>Or even more concisely:</p><pre><code class="language-julia hljs">prod(PreserveTypeProd(ExponentialFamilyDistribution), prior, likelihood)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ExponentialFamily(Bernoulli)</code></pre><p>In this example, multiplying two <code>Bernoulli</code> distributions will always result in another <code>Bernoulli</code> distribution. However, this is not the case for all distributions. For instance, the product of two <code>Laplace</code> distributions may not yield another <code>Laplace</code> distribution, and representing the result in the same form might not be possible. In such cases, it&#39;s advisable to calculate the result within the exponential family domain. This is because the product of two exponential family distributions can always be represented as another exponential family distribution, as shown here:</p><pre><code class="language-julia hljs">prior = Laplace(2.0, 3.0)
likelihood = Laplace(1.0, 4.0)

prod(PreserveTypeProd(ExponentialFamilyDistribution), prior, likelihood)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ExponentialFamily(Univariate)</code></pre><p>Note that the result does not correspond to the <code>Laplace</code> distribution and returns a generic univariate <code>ExponentialFamilyDistribution</code>. This approach ensures consistency and compatibility, especially when dealing with a wide range of probability distributions. Refer to the <a href="https://github.com/ReactiveBayes/BayesBase.jl"><code>BayesBase</code></a> for the documentation about available product strategies.</p><h2 id="Computing-various-useful-attributes-of-an-exponential-family-member"><a class="docs-heading-anchor" href="#Computing-various-useful-attributes-of-an-exponential-family-member">Computing various useful attributes of an exponential family member</a><a id="Computing-various-useful-attributes-of-an-exponential-family-member-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-various-useful-attributes-of-an-exponential-family-member" title="Permalink"></a></h2><p>The package implements attributes of many well known exponential family members, which are defined in <a href="https://en.wikipedia.org/wiki/Exponential_family#Table_of_distributions">this table</a>. The attributes include <a href="../interface/#ExponentialFamily.getbasemeasure"><code>getbasemeasure</code></a>, <a href="../interface/#ExponentialFamily.getsufficientstatistics"><code>getsufficientstatistics</code></a>, <a href="../interface/#ExponentialFamily.getlogpartition"><code>getlogpartition</code></a>, <a href="../interface/#ExponentialFamily.getfisherinformation"><code>getfisherinformation</code></a>, and others.  In general, the interface for these functions assumes a family member &quot;tag,&quot; such as <code>Normal</code> or <code>Bernoulli</code>. Here are some examples of how to use these attributes:</p><pre><code class="language-julia hljs">using ExponentialFamily, Distributions

# Returns a function
basemeasure_of_normal = getbasemeasure(Normal)

basemeasure_of_normal(0.0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.3989422804014327</code></pre><pre><code class="language-julia hljs"># Returns an iterable of functions
sufficientstatistics_of_gamma = getsufficientstatistics(Gamma)

map(f -&gt; f(1.0), sufficientstatistics_of_gamma)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(0.0, 1.0)</code></pre><p>Some distributions, like the <code>Laplace</code> distribution, qualify as exponential family members only under certain conditions or when specific information is known in advance. In such cases, the ExponentialFamily package introduces the concept of a <strong>conditioner</strong>. For instance, the <code>Laplace</code> distribution becomes a member of the exponential family only when the <code>location</code> parameter is known and fixed. Consequently, we <strong>condition</strong> on the <code>location</code> parameter:</p><pre><code class="language-julia hljs">laplace = Laplace(2.0, 1.0)

canonical = convert(ExponentialFamilyDistribution, laplace)

getconditioner(canonical)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2.0</code></pre><pre><code class="language-julia hljs"># For conditioned distributions, the `conditioner` must be present as a second argument
basemeasure_of_laplace = getbasemeasure(Laplace, 2.0)

basemeasure_of_laplace(1.0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>The <a href="../interface/#ExponentialFamily.getlogpartition"><code>getlogpartition</code></a> and <a href="../interface/#ExponentialFamily.getfisherinformation"><code>getfisherinformation</code></a> functions optionally accept a <code>space</code> parameter as the first argument. This <code>space</code> parameter specifies the parameterization <code>space</code>, such as <a href="../interface/#ExponentialFamily.MeanParametersSpace"><code>MeanParametersSpace</code></a> or [<code>NaturalParametersSpace</code>]. The result obtained from these functions (in general) depends on the chosen parameter space:</p><pre><code class="language-julia hljs">logpartition_of_gamma_in_mean_space = getlogpartition(MeanParametersSpace(), Gamma)

gamma_parameters_in_mean_space = [ 1.0, 2.0 ]

logpartition_of_gamma_in_mean_space(gamma_parameters_in_mean_space)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.6931471805599453</code></pre><pre><code class="language-julia hljs">logparition_of_gamma_in_natural_space = getlogpartition(NaturalParametersSpace(), Gamma)

gamma_parameters_in_natural_space = map(
    MeanParametersSpace() =&gt; NaturalParametersSpace(),
    Gamma,
    gamma_parameters_in_mean_space
)

logparition_of_gamma_in_natural_space(gamma_parameters_in_natural_space)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.6931471805599453</code></pre><p>The same principle applies to the Fisher information matrix:</p><pre><code class="language-julia hljs">fisherinformation_of_gamma_in_mean_space = getfisherinformation(MeanParametersSpace(), Gamma)

fisherinformation_of_gamma_in_mean_space(gamma_parameters_in_mean_space)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×2 StaticArraysCore.SMatrix{2, 2, Float64, 4} with indices SOneTo(2)×SOneTo(2):
 1.64493  0.5
 0.5      0.25</code></pre><pre><code class="language-julia hljs">fisherinformation_of_gamma_in_natural_space = getfisherinformation(NaturalParametersSpace(), Gamma)

fisherinformation_of_gamma_in_natural_space(gamma_parameters_in_natural_space)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×2 StaticArraysCore.SMatrix{2, 2, Float64, 4} with indices SOneTo(2)×SOneTo(2):
 1.64493  2.0
 2.0      4.0</code></pre><h2 id="Approximating-attributes"><a class="docs-heading-anchor" href="#Approximating-attributes">Approximating attributes</a><a id="Approximating-attributes-1"></a><a class="docs-heading-anchor-permalink" href="#Approximating-attributes" title="Permalink"></a></h2><p>Refer to the <a href="https://github.com/ReactiveBayes/ExpectationApproximations.jl"><code>ExpectationApproximations.jl</code></a> package for approximating various attributes of the members of the exponential family.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../library/">« Library</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Friday 12 January 2024 15:02">Friday 12 January 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
